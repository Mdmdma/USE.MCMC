<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="USE">
<title>USE_vignette â€¢ USE</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="USE_vignette">
<meta property="og:description" content="USE">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">USE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/USE_vignette.html">USE_vignette</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>USE_vignette</h1>
            
      
      
      <div class="d-none name"><code>USE_vignette.Rmd</code></div>
    </div>

    
    
<p>In this vignette we will go trough the USE package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/locales.html" class="external-link">Sys.setlocale</a></span><span class="op">(</span><span class="st">"LC_ALL"</span>, <span class="st">"English"</span><span class="op">)</span>
<span class="co">#&gt; Warning in Sys.setlocale("LC_ALL", "English"): OS reports request to set locale</span>
<span class="co">#&gt; to "English" cannot be honored</span>
<span class="co">#&gt; [1] ""</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">USE</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster" class="external-link">raster</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://borisleroy.com/virtualspecies" class="external-link">virtualspecies</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://bleutner.github.io/RStoolbox" class="external-link">RStoolbox</a></span><span class="op">)</span>
<span class="co">#&gt; Warning in fun(libname, pkgname): rgeos: versions of GEOS runtime 3.10.2-CAPI-1.16.0</span>
<span class="co">#&gt; and GEOS at installation 3.9.1-CAPI-1.14.2differ</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span>
<span class="va">myCRS</span><span class="op">&lt;-</span><span class="st">"+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"</span></code></pre></div>
<p>Download bioclimatic variables from WorldClim</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Worldclim</span><span class="op">&lt;-</span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/getData.html" class="external-link">getData</a></span><span class="op">(</span><span class="st">'worldclim'</span>, var<span class="op">=</span><span class="st">'bio'</span>, res<span class="op">=</span><span class="fl">10</span><span class="op">)</span> 
<span class="co">#&gt; Warning in raster::getData("worldclim", var = "bio", res = 10): getData will be removed in a future version of raster</span>
<span class="co">#&gt; . Please use the geodata package instead</span></code></pre></div>
<p>Crop the bioclimatic variables to the European extent</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">envData</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/crop.html" class="external-link">crop</a></span><span class="op">(</span><span class="va">Worldclim</span>, <span class="fu"><a href="https://rdrr.io/pkg/raster/man/extent.html" class="external-link">extent</a></span><span class="op">(</span><span class="op">-</span><span class="fl">12</span>, <span class="fl">25</span>, <span class="fl">36</span>, <span class="fl">60</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Create a virtual species. For details about the methodology used, see
the <a href="http://borisleroy.com/files/virtualspecies-tutorial.html#introduction" class="external-link">vignette</a>
of the <strong>virtualspecies</strong> R package</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#create virtual species</span>
<span class="va">myRandNum</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">19</span>,size<span class="op">=</span><span class="fl">5</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">random.sp</span> <span class="op">&lt;-</span> <span class="fu">virtualspecies</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/virtualspecies/man/generateRandomSp.html" class="external-link">generateRandomSp</a></span><span class="op">(</span><span class="va">envData</span><span class="op">[[</span><span class="va">myRandNum</span><span class="op">]</span><span class="op">]</span>, 
                                              convert.to.PA <span class="op">=</span> <span class="cn">FALSE</span>, 
                                              species.type <span class="op">=</span> <span class="st">"additive"</span>,
                                              realistic.sp <span class="op">=</span> <span class="cn">TRUE</span>, 
                                              plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#reclassify suitability raster using a probability conversion rule</span>
<span class="va">new.pres</span><span class="op">&lt;-</span><span class="fu">virtualspecies</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/virtualspecies/man/convertToPA.html" class="external-link">convertToPA</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">random.sp</span>, 
                      beta<span class="op">=</span><span class="fl">0.55</span>,
                      alpha <span class="op">=</span> <span class="op">-</span><span class="fl">0.05</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#Sample true occurrences</span>
<span class="va">presence.points</span> <span class="op">&lt;-</span> <span class="fu">virtualspecies</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/virtualspecies/man/sampleOccurrences.html" class="external-link">sampleOccurrences</a></span><span class="op">(</span><span class="va">new.pres</span>,
                                     n <span class="op">=</span> <span class="fl">300</span>, <span class="co"># The number of points to sample</span>
                                     type <span class="op">=</span> <span class="st">"presence-absence"</span>,
                                     sample.prevalence <span class="op">=</span> <span class="fl">0.6</span>,
                                     detection.probability <span class="op">=</span> <span class="fl">1</span>,
                                     correct.by.suitability <span class="op">=</span> <span class="cn">TRUE</span>,
                                     plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  </code></pre></div>
<p><img src="USE_vignette_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>Create a presence only data set.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myPres</span><span class="op">=</span><span class="va">presence.points</span><span class="op">$</span><span class="va">sample.points</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">presence.points</span><span class="op">$</span><span class="va">sample.points</span><span class="op">$</span><span class="va">Observed</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"x"</span>, <span class="st">"y"</span>,  <span class="st">"Observed"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/xyFromCell.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">myPres</span><span class="op">)</span><span class="op">&lt;-</span><span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="va">y</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/projection.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">myPres</span><span class="op">)</span><span class="op">&lt;-</span><span class="va">myCRS</span>
<span class="va">myPres</span>
<span class="co">#&gt; class       : SpatialPointsDataFrame </span>
<span class="co">#&gt; features    : 142 </span>
<span class="co">#&gt; extent      : -10.25, 24.58333, 36.08333, 59.58333  (xmin, xmax, ymin, ymax)</span>
<span class="co">#&gt; crs         : +proj=longlat +datum=WGS84 +no_defs </span>
<span class="co">#&gt; variables   : 1</span>
<span class="co">#&gt; names       : Observed </span>
<span class="co">#&gt; min values  :        1 </span>
<span class="co">#&gt; max values  :        1</span></code></pre></div>
<p>Find the optimal resolution of the sampling grid. First, made a PCA
on the whole raster stack and then use the PC-scores of the first two
axes to create a new spatial object.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rpc</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/RStoolbox/man/rasterPCA.html" class="external-link">rasterPCA</a></span><span class="op">(</span><span class="va">envData</span>,spca <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/na.omit.data.table.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">rpc</span><span class="op">$</span><span class="va">map</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PC1"</span>, <span class="st">"PC2"</span><span class="op">)</span><span class="op">]</span><span class="op">]</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">dt</span><span class="op">=</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">dt</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PC1"</span>, <span class="st">"PC2"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myRes</span><span class="op">=</span><span class="fu">USE</span><span class="fu">::</span><span class="fu"><a href="../reference/optimRes.html">optimRes</a></span><span class="op">(</span>sdf<span class="op">=</span><span class="va">dt</span>,
                    grid.res<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>,
                    perc.thr <span class="op">=</span> <span class="fl">10</span>,
                    showOpt <span class="op">=</span> <span class="cn">TRUE</span>, 
                    cr<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myRes</span><span class="op">$</span><span class="va">Opt_res</span>
<span class="co">#&gt; [1] 6</span></code></pre></div>
<p>Perform uniform sampling of the environmental space</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myObs</span><span class="op">=</span><span class="fu">USE</span><span class="fu">::</span><span class="fu"><a href="../reference/uniformSampling.html">uniformSampling</a></span><span class="op">(</span>sdf<span class="op">=</span><span class="va">dt</span>, 
                           grid.res<span class="op">=</span><span class="va">myRes</span><span class="op">$</span><span class="va">Opt_res</span>,
                           n.tr <span class="op">=</span> <span class="fl">5</span>,
                           sub.ts <span class="op">=</span> <span class="cn">TRUE</span>,
                           n.ts <span class="op">=</span> <span class="fl">2</span>,
                           plot_proc <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">myObs</span><span class="op">)</span>
<span class="co">#&gt; List of 2</span>
<span class="co">#&gt;  $ Bkg.tr:Classes 'sf', 'data.table' and 'data.frame':   152 obs. of  4 variables:</span>
<span class="co">#&gt;   ..$ x       : num [1:152] 8.92 9.25 9.25 22.58 9.08 ...</span>
<span class="co">#&gt;   ..$ y       : num [1:152] 59.9 59.7 59.9 49.1 59.9 ...</span>
<span class="co">#&gt;   ..$ ID      : chr [1:152] "26" "133" "28" "8504" ...</span>
<span class="co">#&gt;   ..$ geometry:sfc_POINT of length 152; first list element:  'XY' num [1:2] -3.45 -2.94</span>
<span class="co">#&gt;   ..- attr(*, "sf_column")= chr "geometry"</span>
<span class="co">#&gt;   ..- attr(*, "agr")= Factor w/ 3 levels "constant","aggregate",..: NA NA NA</span>
<span class="co">#&gt;   .. ..- attr(*, "names")= chr [1:3] "x" "y" "ID"</span>
<span class="co">#&gt;  $ Bkg.ts:Classes 'sf', 'data.table' and 'data.frame':   58 obs. of  4 variables:</span>
<span class="co">#&gt;   ..$ x       : num [1:58] -8.75 20.08 -8.92 -8.92 -10.42 ...</span>
<span class="co">#&gt;   ..$ y       : num [1:58] 40.7 39.7 42.2 42.9 52.1 ...</span>
<span class="co">#&gt;   ..$ ID      : chr [1:58] "16089" "16870" "14895" "14302" ...</span>
<span class="co">#&gt;   ..$ geometry:sfc_POINT of length 58; first list element:  'XY' num [1:2] 1.76 5.9</span>
<span class="co">#&gt;   ..- attr(*, "sf_column")= chr "geometry"</span>
<span class="co">#&gt;   ..- attr(*, "agr")= Factor w/ 3 levels "constant","aggregate",..: NA NA NA</span>
<span class="co">#&gt;   .. ..- attr(*, "names")= chr [1:3] "x" "y" "ID"</span>
<span class="co">#background points for the training dataset</span>
<span class="va">myObs</span><span class="op">$</span><span class="va">Bkg.tr</span>
<span class="co">#&gt; Simple feature collection with 152 features and 3 fields</span>
<span class="co">#&gt; Geometry type: POINT</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: -13.58791 ymin: -3.72142 xmax: 6.800077 ymax: 7.139334</span>
<span class="co">#&gt; CRS:           NA</span>
<span class="co">#&gt; First 10 features:</span>
<span class="co">#&gt;              x        y   ID                     geometry</span>
<span class="co">#&gt; 26    8.916667 59.91667   26  POINT (-3.445481 -2.938089)</span>
<span class="co">#&gt; 133   9.250000 59.75000  133  POINT (-3.430072 -2.760282)</span>
<span class="co">#&gt; 28    9.250000 59.91667   28  POINT (-3.741414 -3.044682)</span>
<span class="co">#&gt; 8504 22.583333 49.08333 8504   POINT (-2.890885 -2.57662)</span>
<span class="co">#&gt; 27    9.083333 59.91667   27  POINT (-3.641179 -3.006921)</span>
<span class="co">#&gt; 3861 15.250000 53.58333 3861 POINT (-0.2643998 -3.070108)</span>
<span class="co">#&gt; 850  22.750000 58.58333  850 POINT (-0.9664201 -3.180859)</span>
<span class="co">#&gt; 4232 18.916667 53.25000 4232 POINT (0.04427603 -3.332483)</span>
<span class="co">#&gt; 101  23.083333 59.91667  101    POINT (-1.03258 -3.72142)</span>
<span class="co">#&gt; 736  14.750000 58.75000  736 POINT (-0.8184523 -2.743218)</span>
<span class="co">#background points for the testing dataset</span>
<span class="va">myObs</span><span class="op">$</span><span class="va">Bkg.ts</span>
<span class="co">#&gt; Simple feature collection with 58 features and 3 fields</span>
<span class="co">#&gt; Geometry type: POINT</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: -11.38069 ymin: -3.633896 xmax: 6.491139 ymax: 6.959128</span>
<span class="co">#&gt; CRS:           NA</span>
<span class="co">#&gt; First 10 features:</span>
<span class="co">#&gt;                x        y    ID                    geometry</span>
<span class="co">#&gt; 16089  -8.750000 40.75000 16089   POINT (1.759328 5.903501)</span>
<span class="co">#&gt; 16870  20.083333 39.75000 16870   POINT (2.347694 5.856895)</span>
<span class="co">#&gt; 14895  -8.916667 42.25000 14895  POINT (0.1535594 6.959128)</span>
<span class="co">#&gt; 14302  -8.916667 42.91667 14302 POINT (-0.4818205 6.108024)</span>
<span class="co">#&gt; 5360  -10.416667 52.08333  5360   POINT (-4.456471 6.41753)</span>
<span class="co">#&gt; 5176   -9.583333 52.25000  5176  POINT (-3.398675 5.650272)</span>
<span class="co">#&gt; 1546   -4.916667 57.08333  1546  POINT (-6.493316 5.645063)</span>
<span class="co">#&gt; 1923   -5.750000 56.41667  1923  POINT (-6.801299 6.590234)</span>
<span class="co">#&gt; 17386  -8.750000 38.75000 17386   POINT (5.037107 3.941326)</span>
<span class="co">#&gt; 18247   9.416667 37.25000 18247   POINT (5.392803 3.673602)</span></code></pre></div>
<p>Uniformly sampling background points in the environmental space,
accounting for the species presence points.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myGrid.psAbs</span> <span class="op">&lt;-</span> <span class="fu">USE</span><span class="fu">::</span><span class="fu"><a href="../reference/paSampling.html">paSampling</a></span><span class="op">(</span>env.rast<span class="op">=</span><span class="va">envData</span>,
                                pres<span class="op">=</span><span class="va">myPres</span>,
                                thres<span class="op">=</span><span class="fl">0.75</span>,
                                H<span class="op">=</span><span class="cn">NULL</span>,
                                grid.res<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">myRes</span><span class="op">$</span><span class="va">Opt_res</span><span class="op">)</span>,
                                n.tr <span class="op">=</span> <span class="fl">5</span>,
                                prev<span class="op">=</span><span class="fl">0.3</span>,
                                sub.ts<span class="op">=</span><span class="cn">TRUE</span>,
                                n.ts<span class="op">=</span><span class="fl">5</span>,
                                plot_proc<span class="op">=</span><span class="cn">FALSE</span>,
                                verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">myGrid.psAbs</span><span class="op">)</span>
<span class="co">#&gt; List of 2</span>
<span class="co">#&gt;  $ Bkg.tr:Classes 'sf' and 'data.frame': 494 obs. of  27 variables:</span>
<span class="co">#&gt;   ..$ KDE     : num [1:494] 0.000352 0.00038 0.001166 0.004827 0.003407 ...</span>
<span class="co">#&gt;   ..$ myID    : num [1:494] 125 128 130 142 143 348 350 351 352 150 ...</span>
<span class="co">#&gt;   ..$ PA      : num [1:494] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;   ..$ percP   : chr [1:494] "out" "out" "out" "out" ...</span>
<span class="co">#&gt;   ..$ x       : num [1:494] 8.75 9.25 9.58 11.58 11.75 ...</span>
<span class="co">#&gt;   ..$ y       : num [1:494] 59.9 59.9 59.9 59.9 59.9 ...</span>
<span class="co">#&gt;   ..$ bio1    : num [1:494] 13 16 35 46 44 18 25 27 38 45 ...</span>
<span class="co">#&gt;   ..$ bio2    : num [1:494] 75 76 76 69 70 73 73 73 72 76 ...</span>
<span class="co">#&gt;   ..$ bio3    : num [1:494] 27 26 26 24 24 26 26 26 25 26 ...</span>
<span class="co">#&gt;   ..$ bio4    : num [1:494] 7053 7328 7619 7597 7577 ...</span>
<span class="co">#&gt;   ..$ bio5    : num [1:494] 164 171 193 199 197 168 176 180 191 200 ...</span>
<span class="co">#&gt;   ..$ bio6    : num [1:494] -112 -113 -98 -85 -88 -106 -102 -100 -90 -90 ...</span>
<span class="co">#&gt;   ..$ bio7    : num [1:494] 276 284 291 284 285 274 278 280 281 290 ...</span>
<span class="co">#&gt;   ..$ bio8    : num [1:494] 66 101 123 99 96 71 109 113 92 131 ...</span>
<span class="co">#&gt;   ..$ bio9    : num [1:494] -42 -40 -21 -13 -16 -37 -31 -29 -18 -14 ...</span>
<span class="co">#&gt;   ..$ bio10   : num [1:494] 106 112 134 146 143 111 119 123 135 144 ...</span>
<span class="co">#&gt;   ..$ bio11   : num [1:494] -76 -77 -62 -50 -53 -70 -66 -65 -56 -51 ...</span>
<span class="co">#&gt;   ..$ bio12   : num [1:494] 844 820 756 798 793 839 817 806 772 703 ...</span>
<span class="co">#&gt;   ..$ bio13   : num [1:494] 103 102 95 90 90 103 101 99 95 83 ...</span>
<span class="co">#&gt;   ..$ bio14   : num [1:494] 41 41 37 41 41 41 41 41 38 34 ...</span>
<span class="co">#&gt;   ..$ bio15   : num [1:494] 27 28 29 26 26 28 28 27 28 29 ...</span>
<span class="co">#&gt;   ..$ bio16   : num [1:494] 282 277 258 261 258 281 273 269 261 238 ...</span>
<span class="co">#&gt;   ..$ bio17   : num [1:494] 134 130 119 132 131 133 131 130 124 112 ...</span>
<span class="co">#&gt;   ..$ bio18   : num [1:494] 264 265 245 246 248 262 258 255 243 230 ...</span>
<span class="co">#&gt;   ..$ bio19   : num [1:494] 171 158 140 156 154 167 159 155 145 131 ...</span>
<span class="co">#&gt;   ..$ ID      : chr [1:494] "16" "17" "18" "25" ...</span>
<span class="co">#&gt;   ..$ geometry:sfc_POINT of length 494; first list element:  'XY' num [1:2] -4.04 -2.58</span>
<span class="co">#&gt;   ..- attr(*, "sf_column")= chr "geometry"</span>
<span class="co">#&gt;   ..- attr(*, "agr")= Factor w/ 3 levels "constant","aggregate",..: NA NA NA NA NA NA NA NA NA NA ...</span>
<span class="co">#&gt;   .. ..- attr(*, "names")= chr [1:26] "KDE" "myID" "PA" "percP" ...</span>
<span class="co">#&gt;  $ Bkg.ts:Classes 'sf' and 'data.frame': 313 obs. of  27 variables:</span>
<span class="co">#&gt;   ..$ KDE     : num [1:313] 0.000842 0.001535 0.001566 0.000774 0.000791 ...</span>
<span class="co">#&gt;   ..$ myID    : num [1:313] 22886 22888 25332 24218 23551 ...</span>
<span class="co">#&gt;   ..$ PA      : num [1:313] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;   ..$ percP   : chr [1:313] "out" "out" "out" "out" ...</span>
<span class="co">#&gt;   ..$ x       : num [1:313] -8.75 -8.42 -8.08 -8.75 -8.92 ...</span>
<span class="co">#&gt;   ..$ y       : num [1:313] 42.7 42.7 40.9 41.7 42.2 ...</span>
<span class="co">#&gt;   ..$ bio1    : num [1:313] 137 136 126 137 148 123 132 133 140 129 ...</span>
<span class="co">#&gt;   ..$ bio2    : num [1:313] 65 75 94 76 61 85 80 65 83 68 ...</span>
<span class="co">#&gt;   ..$ bio3    : num [1:313] 38 38 40 42 39 39 39 39 40 39 ...</span>
<span class="co">#&gt;   ..$ bio4    : num [1:313] 3649 3992 4825 3718 3445 ...</span>
<span class="co">#&gt;   ..$ bio5    : num [1:313] 233 245 259 235 232 244 245 225 255 228 ...</span>
<span class="co">#&gt;   ..$ bio6    : num [1:313] 63 51 26 57 78 29 43 60 50 54 ...</span>
<span class="co">#&gt;   ..$ bio7    : num [1:313] 170 194 233 178 154 215 202 165 205 174 ...</span>
<span class="co">#&gt;   ..$ bio8    : num [1:313] 100 94 66 91 112 74 87 100 94 94 ...</span>
<span class="co">#&gt;   ..$ bio9    : num [1:313] 183 188 188 184 191 182 184 175 195 174 ...</span>
<span class="co">#&gt;   ..$ bio10   : num [1:313] 186 190 189 186 192 182 187 179 196 178 ...</span>
<span class="co">#&gt;   ..$ bio11   : num [1:313] 92 88 66 91 104 68 83 91 86 86 ...</span>
<span class="co">#&gt;   ..$ bio12   : num [1:313] 1303 1331 1337 1370 1293 ...</span>
<span class="co">#&gt;   ..$ bio13   : num [1:313] 191 197 196 187 181 210 194 164 203 177 ...</span>
<span class="co">#&gt;   ..$ bio14   : num [1:313] 33 35 15 19 26 30 35 33 24 36 ...</span>
<span class="co">#&gt;   ..$ bio15   : num [1:313] 45 45 54 51 48 47 44 42 49 41 ...</span>
<span class="co">#&gt;   ..$ bio16   : num [1:313] 512 513 539 550 520 543 503 458 527 487 ...</span>
<span class="co">#&gt;   ..$ bio17   : num [1:313] 131 133 90 96 109 128 134 132 111 140 ...</span>
<span class="co">#&gt;   ..$ bio18   : num [1:313] 152 152 94 117 131 139 152 156 126 163 ...</span>
<span class="co">#&gt;   ..$ bio19   : num [1:313] 475 487 539 550 486 532 482 408 515 445 ...</span>
<span class="co">#&gt;   ..$ ID      : chr [1:313] "3076" "3078" "3790" "3434" ...</span>
<span class="co">#&gt;   ..$ geometry:sfc_POINT of length 313; first list element:  'XY' num [1:2] -0.472 6.57</span>
<span class="co">#&gt;   ..- attr(*, "sf_column")= chr "geometry"</span>
<span class="co">#&gt;   ..- attr(*, "agr")= Factor w/ 3 levels "constant","aggregate",..: NA NA NA NA NA NA NA NA NA NA ...</span>
<span class="co">#&gt;   .. ..- attr(*, "names")= chr [1:26] "KDE" "myID" "PA" "percP" ...</span>
<span class="co">#background points for the training dataset</span>
<span class="va">myGrid.psAbs</span><span class="op">$</span><span class="va">Bkg.tr</span>
<span class="co">#&gt; Simple feature collection with 494 features and 26 fields</span>
<span class="co">#&gt; Geometry type: POINT</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: -13.58791 ymin: -4.483249 xmax: 6.97369 ymax: 7.630419</span>
<span class="co">#&gt; CRS:           NA</span>
<span class="co">#&gt; First 10 features:</span>
<span class="co">#&gt;             KDE myID PA percP         x        y bio1 bio2 bio3 bio4 bio5 bio6</span>
<span class="co">#&gt; 16 0.0003518053  125  0   out  8.750000 59.91667   13   75   27 7053  164 -112</span>
<span class="co">#&gt; 17 0.0003799395  128  0   out  9.250000 59.91667   16   76   26 7328  171 -113</span>
<span class="co">#&gt; 18 0.0011658064  130  0   out  9.583333 59.91667   35   76   26 7619  193  -98</span>
<span class="co">#&gt; 25 0.0048266103  142  0   out 11.583333 59.91667   46   69   24 7597  199  -85</span>
<span class="co">#&gt; 26 0.0034065575  143  0   out 11.750000 59.91667   44   70   24 7577  197  -88</span>
<span class="co">#&gt; 56 0.0004986511  348  0   out  8.916667 59.75000   18   73   26 7051  168 -106</span>
<span class="co">#&gt; 57 0.0006048808  350  0   out  9.250000 59.75000   25   73   26 7183  176 -102</span>
<span class="co">#&gt; 58 0.0006311931  351  0   out  9.416667 59.75000   27   73   26 7300  180 -100</span>
<span class="co">#&gt; 59 0.0034854319  352  0   out  9.583333 59.75000   38   72   25 7389  191  -90</span>
<span class="co">#&gt; 31 0.0089087937  150  0   out 12.916667 59.91667   45   76   26 7563  200  -90</span>
<span class="co">#&gt;    bio7 bio8 bio9 bio10 bio11 bio12 bio13 bio14 bio15 bio16 bio17 bio18 bio19</span>
<span class="co">#&gt; 16  276   66  -42   106   -76   844   103    41    27   282   134   264   171</span>
<span class="co">#&gt; 17  284  101  -40   112   -77   820   102    41    28   277   130   265   158</span>
<span class="co">#&gt; 18  291  123  -21   134   -62   756    95    37    29   258   119   245   140</span>
<span class="co">#&gt; 25  284   99  -13   146   -50   798    90    41    26   261   132   246   156</span>
<span class="co">#&gt; 26  285   96  -16   143   -53   793    90    41    26   258   131   248   154</span>
<span class="co">#&gt; 56  274   71  -37   111   -70   839   103    41    28   281   133   262   167</span>
<span class="co">#&gt; 57  278  109  -31   119   -66   817   101    41    28   273   131   258   159</span>
<span class="co">#&gt; 58  280  113  -29   123   -65   806    99    41    27   269   130   255   155</span>
<span class="co">#&gt; 59  281   92  -18   135   -56   772    95    38    28   261   124   243   145</span>
<span class="co">#&gt; 31  290  131  -14   144   -51   703    83    34    29   238   112   230   131</span>
<span class="co">#&gt;    ID                    geometry</span>
<span class="co">#&gt; 16 16 POINT (-4.041346 -2.577969)</span>
<span class="co">#&gt; 17 17 POINT (-3.741414 -3.044682)</span>
<span class="co">#&gt; 18 18 POINT (-2.552753 -3.139665)</span>
<span class="co">#&gt; 25 25 POINT (-2.562465 -2.663995)</span>
<span class="co">#&gt; 26 26 POINT (-2.641587 -2.743201)</span>
<span class="co">#&gt; 56 56 POINT (-3.853077 -2.523284)</span>
<span class="co">#&gt; 57 57 POINT (-3.430072 -2.760282)</span>
<span class="co">#&gt; 58 58  POINT (-3.270331 -2.84089)</span>
<span class="co">#&gt; 59 59 POINT (-2.696467 -2.695892)</span>
<span class="co">#&gt; 31 31 POINT (-1.878144 -3.179145)</span>
<span class="co">#background points for the testing dataset</span>
<span class="va">myGrid.psAbs</span><span class="op">$</span><span class="va">Bkg.ts</span>
<span class="co">#&gt; Simple feature collection with 313 features and 26 fields</span>
<span class="co">#&gt; Geometry type: POINT</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: -12.93306 ymin: -4.46269 xmax: 6.838346 ymax: 7.188879</span>
<span class="co">#&gt; CRS:           NA</span>
<span class="co">#&gt; First 10 features:</span>
<span class="co">#&gt;               KDE  myID PA percP         x        y bio1 bio2 bio3 bio4 bio5</span>
<span class="co">#&gt; 3076 0.0008424206 22886  0   out -8.750000 42.75000  137   65   38 3649  233</span>
<span class="co">#&gt; 3078 0.0015354148 22888  0   out -8.416667 42.75000  136   75   38 3992  245</span>
<span class="co">#&gt; 3790 0.0015664237 25332  0   out -8.083333 40.91667  126   94   40 4825  259</span>
<span class="co">#&gt; 3434 0.0007744988 24218  0   out -8.750000 41.75000  137   76   42 3718  235</span>
<span class="co">#&gt; 3230 0.0007908221 23551  0   out -8.916667 42.25000  148   61   39 3445  232</span>
<span class="co">#&gt; 3234 0.0017867435 23555  0   out -8.250000 42.25000  123   85   39 4514  244</span>
<span class="co">#&gt; 3079 0.0021191116 22889  0   out -8.250000 42.75000  132   80   39 4069  245</span>
<span class="co">#&gt; 2926 0.0023685764 22441  0   out -8.916667 43.08333  133   65   39 3398  225</span>
<span class="co">#&gt; 3302 0.0007172080 23776  0   out -8.416667 42.08333  140   83   40 4278  255</span>
<span class="co">#&gt; 2927 0.0017581440 22442  0   out -8.750000 43.08333  129   68   39 3584  228</span>
<span class="co">#&gt;      bio6 bio7 bio8 bio9 bio10 bio11 bio12 bio13 bio14 bio15 bio16 bio17 bio18</span>
<span class="co">#&gt; 3076   63  170  100  183   186    92  1303   191    33    45   512   131   152</span>
<span class="co">#&gt; 3078   51  194   94  188   190    88  1331   197    35    45   513   133   152</span>
<span class="co">#&gt; 3790   26  233   66  188   189    66  1337   196    15    54   539    90    94</span>
<span class="co">#&gt; 3434   57  178   91  184   186    91  1370   187    19    51   550    96   117</span>
<span class="co">#&gt; 3230   78  154  112  191   192   104  1293   181    26    48   520   109   131</span>
<span class="co">#&gt; 3234   29  215   74  182   182    68  1396   210    30    47   543   128   139</span>
<span class="co">#&gt; 3079   43  202   87  184   187    83  1321   194    35    44   503   134   152</span>
<span class="co">#&gt; 2926   60  165  100  175   179    91  1175   164    33    42   458   132   156</span>
<span class="co">#&gt; 3302   50  205   94  195   196    86  1333   203    24    49   527   111   126</span>
<span class="co">#&gt; 2927   54  174   94  174   178    86  1261   177    36    41   487   140   163</span>
<span class="co">#&gt;      bio19   ID                    geometry</span>
<span class="co">#&gt; 3076   475 3076 POINT (-0.4722045 6.569908)</span>
<span class="co">#&gt; 3078   487 3078   POINT (-0.33467 6.342836)</span>
<span class="co">#&gt; 3790   539 3790  POINT (0.5825749 5.827699)</span>
<span class="co">#&gt; 3434   550 3434  POINT (0.1703095 7.026533)</span>
<span class="co">#&gt; 3230   486 3230  POINT (0.1535594 6.959128)</span>
<span class="co">#&gt; 3234   532 3234 POINT (-0.6382789 6.180318)</span>
<span class="co">#&gt; 3079   482 3079 POINT (-0.3375594 6.131956)</span>
<span class="co">#&gt; 2926   408 2926  POINT (-0.271826 5.904578)</span>
<span class="co">#&gt; 3302   515 3302    POINT (0.3737173 6.4411)</span>
<span class="co">#&gt; 2927   445 2927 POINT (-0.6801149 6.125918)</span></code></pre></div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Daniele Da Re, Enrico Tordoni, Manuele Bazzichetto.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
