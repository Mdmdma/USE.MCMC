<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>USE_vignette â€¢ USE</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="USE_vignette">
<meta property="og:description" content="USE">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">USE</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/USE_vignette.html">USE_vignette</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>USE_vignette</h1>
            
      
      
      <div class="hidden name"><code>USE_vignette.Rmd</code></div>

    </div>

    
    
<p>In this vignette we will go trough the UEsampling package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/locales.html" class="external-link">Sys.setlocale</a></span><span class="op">(</span><span class="st">"LC_ALL"</span>, <span class="st">"English"</span><span class="op">)</span>
<span class="co">#&gt; Warning in Sys.setlocale("LC_ALL", "English"): OS reports request to set locale</span>
<span class="co">#&gt; to "English" cannot be honored</span>
<span class="co">#&gt; [1] ""</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">USE</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster" class="external-link">raster</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://borisleroy.com/virtualspecies" class="external-link">virtualspecies</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://bleutner.github.io/RStoolbox" class="external-link">RStoolbox</a></span><span class="op">)</span>
<span class="co">#&gt; Warning in fun(libname, pkgname): rgeos: versions of GEOS runtime 3.10.2-CAPI-1.16.0</span>
<span class="co">#&gt; and GEOS at installation 3.9.1-CAPI-1.14.2differ</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span>
<span class="va">myCRS</span><span class="op">&lt;-</span><span class="st">"+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"</span></code></pre></div>
<p>Download bioclimatic variables from WorldClim</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Worldclim</span><span class="op">&lt;-</span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/getData.html" class="external-link">getData</a></span><span class="op">(</span><span class="st">'worldclim'</span>, var<span class="op">=</span><span class="st">'bio'</span>, res<span class="op">=</span><span class="fl">10</span><span class="op">)</span> </code></pre></div>
<p>Crop the bioclimatic variables to the European extent</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">envData</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/crop.html" class="external-link">crop</a></span><span class="op">(</span><span class="va">Worldclim</span>, <span class="fu"><a href="https://rdrr.io/pkg/raster/man/extent.html" class="external-link">extent</a></span><span class="op">(</span><span class="op">-</span><span class="fl">12</span>, <span class="fl">25</span>, <span class="fl">36</span>, <span class="fl">60</span><span class="op">)</span><span class="op">)</span>
<span class="va">envData</span>
<span class="co">#&gt; class      : RasterBrick </span>
<span class="co">#&gt; dimensions : 144, 222, 31968, 19  (nrow, ncol, ncell, nlayers)</span>
<span class="co">#&gt; resolution : 0.1666667, 0.1666667  (x, y)</span>
<span class="co">#&gt; extent     : -12, 25, 36, 60  (xmin, xmax, ymin, ymax)</span>
<span class="co">#&gt; crs        : +proj=longlat +datum=WGS84 +no_defs </span>
<span class="co">#&gt; source     : memory</span>
<span class="co">#&gt; names      : bio1, bio2, bio3, bio4, bio5, bio6, bio7, bio8, bio9, bio10, bio11, bio12, bio13, bio14, bio15, ... </span>
<span class="co">#&gt; min values :  -29,   36,   19, 2680,   75, -129,  127,  -72,  -87,    37,   -93,   221,    31,     0,     7, ... </span>
<span class="co">#&gt; max values :  186,  135,   47, 8893,  368,   97,  342,  204,  275,   277,   129,  2373,   290,   153,   100, ...</span></code></pre></div>
<p>Create virtual species. For details about the methodology used, see
the <a href="http://borisleroy.com/files/virtualspecies-tutorial.html#introduction" class="external-link">vignette</a>
of the <strong>virtualspecies</strong> R package</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#create virtual species</span>
<span class="va">myRandNum</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">19</span>,size<span class="op">=</span><span class="fl">5</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">random.sp</span> <span class="op">&lt;-</span> <span class="fu">virtualspecies</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/virtualspecies/man/generateRandomSp.html" class="external-link">generateRandomSp</a></span><span class="op">(</span><span class="va">envData</span><span class="op">[[</span><span class="va">myRandNum</span><span class="op">]</span><span class="op">]</span>, 
                                              convert.to.PA <span class="op">=</span> <span class="cn">FALSE</span>, 
                                              species.type <span class="op">=</span> <span class="st">"additive"</span>,
                                              realistic.sp <span class="op">=</span> <span class="cn">TRUE</span>, 
                                              plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#reclassify suitability raster using a probability conversion rule</span>
<span class="va">new.pres</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/virtualspecies/man/convertToPA.html" class="external-link">convertToPA</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">random.sp</span>, 
                      beta<span class="op">=</span><span class="fl">0.55</span>,
                      alpha <span class="op">=</span> <span class="op">-</span><span class="fl">0.05</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#Sample true occurrences</span>
<span class="va">presence.points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/virtualspecies/man/sampleOccurrences.html" class="external-link">sampleOccurrences</a></span><span class="op">(</span><span class="va">new.pres</span>,
                                     n <span class="op">=</span> <span class="fl">300</span>, <span class="co"># The number of points to sample</span>
                                     type <span class="op">=</span> <span class="st">"presence-absence"</span>,
                                     sample.prevalence <span class="op">=</span> <span class="fl">0.6</span>,
                                     detection.probability <span class="op">=</span> <span class="fl">1</span>,
                                     correct.by.suitability <span class="op">=</span> <span class="cn">TRUE</span>,
                                     plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  </code></pre></div>
<p><img src="USE_vignette_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>Get a presence only dataset.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myPres</span><span class="op">=</span><span class="va">presence.points</span><span class="op">$</span><span class="va">sample.points</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">presence.points</span><span class="op">$</span><span class="va">sample.points</span><span class="op">$</span><span class="va">Observed</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"x"</span>, <span class="st">"y"</span>,  <span class="st">"Observed"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/xyFromCell.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">myPres</span><span class="op">)</span><span class="op">&lt;-</span><span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="va">y</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/projection.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">myPres</span><span class="op">)</span><span class="op">&lt;-</span><span class="va">myCRS</span>
<span class="va">myPres</span>
<span class="co">#&gt; class       : SpatialPointsDataFrame </span>
<span class="co">#&gt; features    : 108 </span>
<span class="co">#&gt; extent      : -9.75, 24.91667, 36.08333, 58.75  (xmin, xmax, ymin, ymax)</span>
<span class="co">#&gt; crs         : +proj=longlat +datum=WGS84 +no_defs </span>
<span class="co">#&gt; variables   : 1</span>
<span class="co">#&gt; names       : Observed </span>
<span class="co">#&gt; min values  :        1 </span>
<span class="co">#&gt; max values  :        1</span></code></pre></div>
<p>Find optimal resolution of the sampling grid. First, made a PCA on
the whole raster stack and then use the PC-scores of the first two axes
to create a new spatial object.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rpc</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/RStoolbox/man/rasterPCA.html" class="external-link">rasterPCA</a></span><span class="op">(</span><span class="va">envData</span>,spca <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/na.omit.data.table.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">rpc</span><span class="op">$</span><span class="va">map</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PC1"</span>, <span class="st">"PC2"</span><span class="op">)</span><span class="op">]</span><span class="op">]</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">dt</span><span class="op">=</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">dt</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PC1"</span>, <span class="st">"PC2"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myRes</span><span class="op">=</span><span class="fu">USE</span><span class="fu">::</span><span class="fu"><a href="../reference/optimRes.html">optimRes</a></span><span class="op">(</span>sdf<span class="op">=</span><span class="va">dt</span>,
                    grid.res<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>,
                    perc.thr <span class="op">=</span> <span class="fl">10</span>,
                    showOpt <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myRes</span><span class="op">$</span><span class="va">Opt_res</span>
<span class="co">#&gt; [1] 6</span></code></pre></div>
<p>Perform uniform sampling of the environmental space</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myObs</span><span class="op">=</span><span class="fu">USE</span><span class="fu">::</span><span class="fu"><a href="../reference/uniformSampling.html">uniformSampling</a></span><span class="op">(</span>sdf<span class="op">=</span><span class="va">dt</span>, 
                           grid.res<span class="op">=</span><span class="va">myRes</span><span class="op">$</span><span class="va">Opt_res</span>,
                           n.tr <span class="op">=</span> <span class="fl">5</span>,
                           sub.ts <span class="op">=</span> <span class="cn">TRUE</span>,
                           n.ts <span class="op">=</span> <span class="fl">2</span>,
                           plot_proc <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">myObs</span><span class="op">)</span>
<span class="co">#&gt; List of 2</span>
<span class="co">#&gt;  $ Bkg.tr:Classes 'sf', 'data.table' and 'data.frame':   152 obs. of  4 variables:</span>
<span class="co">#&gt;   ..$ x       : num [1:152] 22.58 10.08 22.25 8.92 9.08 ...</span>
<span class="co">#&gt;   ..$ y       : num [1:152] 49.1 59.9 49.2 59.9 59.8 ...</span>
<span class="co">#&gt;   ..$ ID      : chr [1:152] "8504" "33" "8342" "26" ...</span>
<span class="co">#&gt;   ..$ geometry:sfc_POINT of length 152; first list element:  'XY' num [1:2] -2.89 -2.58</span>
<span class="co">#&gt;   ..- attr(*, "sf_column")= chr "geometry"</span>
<span class="co">#&gt;   ..- attr(*, "agr")= Factor w/ 3 levels "constant","aggregate",..: NA NA NA</span>
<span class="co">#&gt;   .. ..- attr(*, "names")= chr [1:3] "x" "y" "ID"</span>
<span class="co">#&gt;  $ Bkg.ts:Classes 'sf', 'data.table' and 'data.frame':   58 obs. of  4 variables:</span>
<span class="co">#&gt;   ..$ x       : num [1:58] -8.58 -8.25 -7.92 -8.25 -6.42 ...</span>
<span class="co">#&gt;   ..$ y       : num [1:58] 40.8 40.6 40.9 42.9 56.6 ...</span>
<span class="co">#&gt;   ..$ ID      : chr [1:58] "16090" "16219" "15969" "14306" ...</span>
<span class="co">#&gt;   ..$ geometry:sfc_POINT of length 58; first list element:  'XY' num [1:2] 1.99 5.72</span>
<span class="co">#&gt;   ..- attr(*, "sf_column")= chr "geometry"</span>
<span class="co">#&gt;   ..- attr(*, "agr")= Factor w/ 3 levels "constant","aggregate",..: NA NA NA</span>
<span class="co">#&gt;   .. ..- attr(*, "names")= chr [1:3] "x" "y" "ID"</span>
<span class="co">#background points for the training dataset</span>
<span class="va">myObs</span><span class="op">$</span><span class="va">Bkg.tr</span>
<span class="co">#&gt; Simple feature collection with 152 features and 3 fields</span>
<span class="co">#&gt; Geometry type: POINT</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: -13.2887 ymin: -3.662752 xmax: 6.715327 ymax: 7.500397</span>
<span class="co">#&gt; CRS:           NA</span>
<span class="co">#&gt; First 10 features:</span>
<span class="co">#&gt;              x        y   ID                     geometry</span>
<span class="co">#&gt; 8504 22.583333 49.08333 8504   POINT (-2.890885 -2.57662)</span>
<span class="co">#&gt; 33   10.083333 59.91667   33  POINT (-2.869542 -2.947099)</span>
<span class="co">#&gt; 8342 22.250000 49.25000 8342  POINT (-2.793576 -2.840835)</span>
<span class="co">#&gt; 26    8.916667 59.91667   26  POINT (-3.445481 -2.938089)</span>
<span class="co">#&gt; 132   9.083333 59.75000  132  POINT (-2.755422 -2.649471)</span>
<span class="co">#&gt; 3286 19.916667 54.25000 3286 POINT (-0.7662644 -2.931211)</span>
<span class="co">#&gt; 5297 14.750000 52.25000 5297  POINT (0.5242052 -3.119347)</span>
<span class="co">#&gt; 3564 17.750000 53.91667 3564  POINT (-0.8618309 -3.24597)</span>
<span class="co">#&gt; 1111 24.416667 58.08333 1111  POINT (-1.261726 -3.662752)</span>
<span class="co">#&gt; 823  13.583333 58.58333  823 POINT (-0.7705429 -2.731619)</span>
<span class="co">#background points for the testing dataset</span>
<span class="va">myObs</span><span class="op">$</span><span class="va">Bkg.ts</span>
<span class="co">#&gt; Simple feature collection with 58 features and 3 fields</span>
<span class="co">#&gt; Geometry type: POINT</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: -12.45646 ymin: -3.465912 xmax: 6.990233 ymax: 6.93704</span>
<span class="co">#&gt; CRS:           NA</span>
<span class="co">#&gt; First 10 features:</span>
<span class="co">#&gt;               x        y    ID                   geometry</span>
<span class="co">#&gt; 16090 -8.583333 40.75000 16090  POINT (1.986263 5.723278)</span>
<span class="co">#&gt; 16219 -8.250000 40.58333 16219  POINT (1.118266 5.630017)</span>
<span class="co">#&gt; 15969 -7.916667 40.91667 15969 POINT (0.2395791 5.799775)</span>
<span class="co">#&gt; 14306 -8.250000 42.91667 14306 POINT (-0.2905432 6.00018)</span>
<span class="co">#&gt; 1825  -6.416667 56.58333  1825 POINT (-5.047199 5.817151)</span>
<span class="co">#&gt; 5556  -9.250000 51.91667  5556 POINT (-3.927985 5.638636)</span>
<span class="co">#&gt; 1830  -5.583333 56.58333  1830  POINT (-7.442602 6.93704)</span>
<span class="co">#&gt; 2199  -5.250000 55.91667  2199  POINT (-6.542086 6.44212)</span>
<span class="co">#&gt; 18414  7.916667 36.91667 18414  POINT (5.259752 3.966571)</span>
<span class="co">#&gt; 17480 -8.583333 38.58333 17480  POINT (5.268476 3.646357)</span></code></pre></div>
<p>Uniformly sampling background points in the environmental space,
accounting for the species presence points.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myGrid.psAbs</span> <span class="op">&lt;-</span> <span class="fu">USE</span><span class="fu">::</span><span class="fu"><a href="../reference/paSampling.html">paSampling</a></span><span class="op">(</span>env.rast<span class="op">=</span><span class="va">envData</span>,
                                pres<span class="op">=</span><span class="va">myPres</span>,
                                thres<span class="op">=</span><span class="fl">0.75</span>,
                                H<span class="op">=</span><span class="cn">NULL</span>,
                                grid.res<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">myRes</span><span class="op">$</span><span class="va">Opt_res</span><span class="op">)</span>,
                                n.tr <span class="op">=</span> <span class="fl">5</span>,
                                prev<span class="op">=</span><span class="fl">0.3</span>,
                                sub.ts<span class="op">=</span><span class="cn">TRUE</span>,
                                n.ts<span class="op">=</span><span class="fl">5</span>,
                                plot_proc<span class="op">=</span><span class="cn">FALSE</span>,
                                verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; Warning: [vect] argument 'crs' should be a character value</span>

<span class="co">#&gt; Warning: [vect] argument 'crs' should be a character value</span>
<span class="co">#&gt; Warning: Deprecated</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">myGrid.psAbs</span><span class="op">)</span>
<span class="co">#&gt; List of 2</span>
<span class="co">#&gt;  $ Bkg.tr:Classes 'sf' and 'data.frame': 378 obs. of  27 variables:</span>
<span class="co">#&gt;   ..$ KDE     : num [1:378] 0.000631 0.00038 0.001166 0.000499 0.004313 ...</span>
<span class="co">#&gt;   ..$ myID    : num [1:378] 351 128 130 348 14637 ...</span>
<span class="co">#&gt;   ..$ PA      : num [1:378] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;   ..$ percP   : chr [1:378] "out" "out" "out" "out" ...</span>
<span class="co">#&gt;   ..$ x       : num [1:378] 9.42 9.25 9.58 8.92 22.42 ...</span>
<span class="co">#&gt;   ..$ y       : num [1:378] 59.8 59.9 59.9 59.8 49.1 ...</span>
<span class="co">#&gt;   ..$ bio1    : int [1:378] 27 16 35 18 55 44 51 13 25 38 ...</span>
<span class="co">#&gt;   ..$ bio2    : int [1:378] 73 76 76 73 84 70 82 75 73 72 ...</span>
<span class="co">#&gt;   ..$ bio3    : int [1:378] 26 26 26 26 27 24 27 27 26 25 ...</span>
<span class="co">#&gt;   ..$ bio4    : int [1:378] 7300 7328 7619 7051 7621 7577 7529 7053 7183 7389 ...</span>
<span class="co">#&gt;   ..$ bio5    : int [1:378] 180 171 193 168 207 197 201 164 176 191 ...</span>
<span class="co">#&gt;   ..$ bio6    : int [1:378] -100 -113 -98 -106 -94 -88 -95 -112 -102 -90 ...</span>
<span class="co">#&gt;   ..$ bio7    : int [1:378] 280 284 291 274 301 285 296 276 278 281 ...</span>
<span class="co">#&gt;   ..$ bio8    : int [1:378] 113 101 123 71 147 96 143 66 109 92 ...</span>
<span class="co">#&gt;   ..$ bio9    : int [1:378] -29 -40 -21 -37 -38 -16 -41 -42 -31 -18 ...</span>
<span class="co">#&gt;   ..$ bio10   : int [1:378] 123 112 134 111 147 143 143 106 119 135 ...</span>
<span class="co">#&gt;   ..$ bio11   : int [1:378] -65 -77 -62 -70 -49 -53 -51 -76 -66 -56 ...</span>
<span class="co">#&gt;   ..$ bio12   : int [1:378] 806 820 756 839 825 793 845 844 817 772 ...</span>
<span class="co">#&gt;   ..$ bio13   : int [1:378] 99 102 95 103 111 90 114 103 101 95 ...</span>
<span class="co">#&gt;   ..$ bio14   : int [1:378] 41 41 37 41 45 41 46 41 41 38 ...</span>
<span class="co">#&gt;   ..$ bio15   : int [1:378] 27 28 29 28 32 26 33 27 28 28 ...</span>
<span class="co">#&gt;   ..$ bio16   : int [1:378] 269 277 258 281 307 258 315 282 273 261 ...</span>
<span class="co">#&gt;   ..$ bio17   : int [1:378] 130 130 119 133 142 131 146 134 131 124 ...</span>
<span class="co">#&gt;   ..$ bio18   : int [1:378] 255 265 245 262 307 248 315 264 258 243 ...</span>
<span class="co">#&gt;   ..$ bio19   : int [1:378] 155 158 140 167 156 154 159 171 159 145 ...</span>
<span class="co">#&gt;   ..$ ID      : chr [1:378] "67" "20" "21" "65" ...</span>
<span class="co">#&gt;   ..$ geometry:sfc_POINT of length 378; first list element:  'XY' num [1:2] -3.27 -2.84</span>
<span class="co">#&gt;   ..- attr(*, "sf_column")= chr "geometry"</span>
<span class="co">#&gt;   ..- attr(*, "agr")= Factor w/ 3 levels "constant","aggregate",..: NA NA NA NA NA NA NA NA NA NA ...</span>
<span class="co">#&gt;   .. ..- attr(*, "names")= chr [1:26] "KDE" "myID" "PA" "percP" ...</span>
<span class="co">#&gt;  $ Bkg.ts:Classes 'sf' and 'data.frame': 255 obs. of  27 variables:</span>
<span class="co">#&gt;   ..$ KDE     : num [1:255] 0.000674 0.000582 0.001805 0.000245 0.002528 ...</span>
<span class="co">#&gt;   ..$ myID    : num [1:255] 24884 23553 22446 23110 25334 ...</span>
<span class="co">#&gt;   ..$ PA      : num [1:255] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;   ..$ percP   : chr [1:255] "out" "out" "out" "out" ...</span>
<span class="co">#&gt;   ..$ x       : num [1:255] -8.75 -8.58 -8.08 -8.42 -7.75 ...</span>
<span class="co">#&gt;   ..$ y       : num [1:255] 41.2 42.2 43.1 42.6 40.9 ...</span>
<span class="co">#&gt;   ..$ bio1    : int [1:255] 144 140 124 125 116 140 129 131 137 134 ...</span>
<span class="co">#&gt;   ..$ bio2    : int [1:255] 84 71 80 77 92 73 93 79 88 68 ...</span>
<span class="co">#&gt;   ..$ bio3    : int [1:255] 45 39 40 38 38 41 41 40 41 40 ...</span>
<span class="co">#&gt;   ..$ bio4    : int [1:255] 3633 3920 3884 4118 5256 3689 4546 4035 4297 3439 ...</span>
<span class="co">#&gt;   ..$ bio5    : int [1:255] 241 239 234 238 258 236 254 239 255 229 ...</span>
<span class="co">#&gt;   ..$ bio6    : int [1:255] 57 60 38 39 16 62 31 46 44 60 ...</span>
<span class="co">#&gt;   ..$ bio7    : int [1:255] 184 179 196 199 242 174 223 193 211 169 ...</span>
<span class="co">#&gt;   ..$ bio8    : int [1:255] 98 98 82 81 53 101 80 88 90 100 ...</span>
<span class="co">#&gt;   ..$ bio9    : int [1:255] 188 190 174 178 186 187 187 183 192 177 ...</span>
<span class="co">#&gt;   ..$ bio10   : int [1:255] 190 191 176 180 186 188 188 184 193 181 ...</span>
<span class="co">#&gt;   ..$ bio11   : int [1:255] 98 91 78 75 53 94 72 81 83 93 ...</span>
<span class="co">#&gt;   ..$ bio12   : int [1:255] 1217 1470 1257 1474 1363 1376 1317 1467 1320 1166 ...</span>
<span class="co">#&gt;   ..$ bio13   : int [1:255] 166 236 174 225 207 195 189 217 186 158 ...</span>
<span class="co">#&gt;   ..$ bio14   : int [1:255] 15 30 37 37 15 21 16 25 19 34 ...</span>
<span class="co">#&gt;   ..$ bio15   : int [1:255] 51 50 40 46 56 51 53 50 50 40 ...</span>
<span class="co">#&gt;   ..$ bio16   : int [1:255] 483 592 470 573 557 552 530 586 523 445 ...</span>
<span class="co">#&gt;   ..$ bio17   : int [1:255] 83 123 141 144 90 101 90 114 98 132 ...</span>
<span class="co">#&gt;   ..$ bio18   : int [1:255] 101 140 159 160 90 122 97 130 114 155 ...</span>
<span class="co">#&gt;   ..$ bio19   : int [1:255] 483 584 444 556 557 547 525 585 519 407 ...</span>
<span class="co">#&gt;   ..$ ID      : chr [1:255] "6126" "5624" "5207" "5467" ...</span>
<span class="co">#&gt;   ..$ geometry:sfc_POINT of length 255; first list element:  'XY' num [1:2] 1.24 6.45</span>
<span class="co">#&gt;   ..- attr(*, "sf_column")= chr "geometry"</span>
<span class="co">#&gt;   ..- attr(*, "agr")= Factor w/ 3 levels "constant","aggregate",..: NA NA NA NA NA NA NA NA NA NA ...</span>
<span class="co">#&gt;   .. ..- attr(*, "names")= chr [1:26] "KDE" "myID" "PA" "percP" ...</span>
<span class="co">#background points for the training dataset</span>
<span class="va">myGrid.psAbs</span><span class="op">$</span><span class="va">Bkg.tr</span>
<span class="co">#&gt; Simple feature collection with 378 features and 26 fields</span>
<span class="co">#&gt; Geometry type: POINT</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: -13.58791 ymin: -4.390149 xmax: 7.109969 ymax: 7.093614</span>
<span class="co">#&gt; CRS:           NA</span>
<span class="co">#&gt; First 10 features:</span>
<span class="co">#&gt;               KDE  myID PA percP         x        y bio1 bio2 bio3 bio4 bio5</span>
<span class="co">#&gt; 67   0.0006311931   351  0   out  9.416667 59.75000   27   73   26 7300  180</span>
<span class="co">#&gt; 20   0.0003799395   128  0   out  9.250000 59.91667   16   76   26 7328  171</span>
<span class="co">#&gt; 21   0.0011658064   130  0   out  9.583333 59.91667   35   76   26 7619  193</span>
<span class="co">#&gt; 65   0.0004986511   348  0   out  8.916667 59.75000   18   73   26 7051  168</span>
<span class="co">#&gt; 2474 0.0043125298 14637  0   out 22.416667 49.08333   55   84   27 7621  207</span>
<span class="co">#&gt; 31   0.0034065575   143  0   out 11.750000 59.91667   44   70   24 7577  197</span>
<span class="co">#&gt; 2475 0.0029962382 14638  0   out 22.583333 49.08333   51   82   27 7529  201</span>
<span class="co">#&gt; 19   0.0003518053   125  0   out  8.750000 59.91667   13   75   27 7053  164</span>
<span class="co">#&gt; 66   0.0006048808   350  0   out  9.250000 59.75000   25   73   26 7183  176</span>
<span class="co">#&gt; 68   0.0034854319   352  0   out  9.583333 59.75000   38   72   25 7389  191</span>
<span class="co">#&gt;      bio6 bio7 bio8 bio9 bio10 bio11 bio12 bio13 bio14 bio15 bio16 bio17 bio18</span>
<span class="co">#&gt; 67   -100  280  113  -29   123   -65   806    99    41    27   269   130   255</span>
<span class="co">#&gt; 20   -113  284  101  -40   112   -77   820   102    41    28   277   130   265</span>
<span class="co">#&gt; 21    -98  291  123  -21   134   -62   756    95    37    29   258   119   245</span>
<span class="co">#&gt; 65   -106  274   71  -37   111   -70   839   103    41    28   281   133   262</span>
<span class="co">#&gt; 2474  -94  301  147  -38   147   -49   825   111    45    32   307   142   307</span>
<span class="co">#&gt; 31    -88  285   96  -16   143   -53   793    90    41    26   258   131   248</span>
<span class="co">#&gt; 2475  -95  296  143  -41   143   -51   845   114    46    33   315   146   315</span>
<span class="co">#&gt; 19   -112  276   66  -42   106   -76   844   103    41    27   282   134   264</span>
<span class="co">#&gt; 66   -102  278  109  -31   119   -66   817   101    41    28   273   131   258</span>
<span class="co">#&gt; 68    -90  281   92  -18   135   -56   772    95    38    28   261   124   243</span>
<span class="co">#&gt;      bio19   ID                    geometry</span>
<span class="co">#&gt; 67     155   67  POINT (-3.270331 -2.84089)</span>
<span class="co">#&gt; 20     158   20 POINT (-3.741414 -3.044682)</span>
<span class="co">#&gt; 21     140   21 POINT (-2.552753 -3.139665)</span>
<span class="co">#&gt; 65     167   65 POINT (-3.853077 -2.523284)</span>
<span class="co">#&gt; 2474   156 2474 POINT (-2.589624 -2.691705)</span>
<span class="co">#&gt; 31     154   31 POINT (-2.641587 -2.743201)</span>
<span class="co">#&gt; 2475   159 2475  POINT (-2.890885 -2.57662)</span>
<span class="co">#&gt; 19     171   19 POINT (-4.041346 -2.577969)</span>
<span class="co">#&gt; 66     159   66 POINT (-3.430072 -2.760282)</span>
<span class="co">#&gt; 68     145   68 POINT (-2.696467 -2.695892)</span>
<span class="co">#background points for the testing dataset</span>
<span class="va">myGrid.psAbs</span><span class="op">$</span><span class="va">Bkg.ts</span>
<span class="co">#&gt; Simple feature collection with 255 features and 26 fields</span>
<span class="co">#&gt; Geometry type: POINT</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: -13.2887 ymin: -4.320804 xmax: 6.8402 ymax: 7.630419</span>
<span class="co">#&gt; CRS:           NA</span>
<span class="co">#&gt; First 10 features:</span>
<span class="co">#&gt;               KDE  myID PA percP         x        y bio1 bio2 bio3 bio4 bio5</span>
<span class="co">#&gt; 6126 0.0006744193 24884  0   out -8.750000 41.25000  144   84   45 3633  241</span>
<span class="co">#&gt; 5624 0.0005817627 23553  0   out -8.583333 42.25000  140   71   39 3920  239</span>
<span class="co">#&gt; 5207 0.0018050505 22446  0   out -8.083333 43.08333  124   80   40 3884  234</span>
<span class="co">#&gt; 5467 0.0002450630 23110  0   out -8.416667 42.58333  125   77   38 4118  238</span>
<span class="co">#&gt; 6316 0.0025282850 25334  0   out -7.750000 40.91667  116   92   38 5256  258</span>
<span class="co">#&gt; 5820 0.0006984876 23996  0   out -8.750000 41.91667  140   73   41 3689  236</span>
<span class="co">#&gt; 6313 0.0011968109 25331  0   out -8.250000 40.91667  129   93   41 4546  254</span>
<span class="co">#&gt; 5821 0.0006715987 23997  0   out -8.583333 41.91667  131   79   40 4035  239</span>
<span class="co">#&gt; 5889 0.0006920303 24220  0   out -8.416667 41.75000  137   88   41 4297  255</span>
<span class="co">#&gt; 5126 0.0023260366 22221  0   out -8.583333 43.25000  134   68   40 3439  229</span>
<span class="co">#&gt;      bio6 bio7 bio8 bio9 bio10 bio11 bio12 bio13 bio14 bio15 bio16 bio17 bio18</span>
<span class="co">#&gt; 6126   57  184   98  188   190    98  1217   166    15    51   483    83   101</span>
<span class="co">#&gt; 5624   60  179   98  190   191    91  1470   236    30    50   592   123   140</span>
<span class="co">#&gt; 5207   38  196   82  174   176    78  1257   174    37    40   470   141   159</span>
<span class="co">#&gt; 5467   39  199   81  178   180    75  1474   225    37    46   573   144   160</span>
<span class="co">#&gt; 6316   16  242   53  186   186    53  1363   207    15    56   557    90    90</span>
<span class="co">#&gt; 5820   62  174  101  187   188    94  1376   195    21    51   552   101   122</span>
<span class="co">#&gt; 6313   31  223   80  187   188    72  1317   189    16    53   530    90    97</span>
<span class="co">#&gt; 5821   46  193   88  183   184    81  1467   217    25    50   586   114   130</span>
<span class="co">#&gt; 5889   44  211   90  192   193    83  1320   186    19    50   523    98   114</span>
<span class="co">#&gt; 5126   60  169  100  177   181    93  1166   158    34    40   445   132   155</span>
<span class="co">#&gt;      bio19   ID                     geometry</span>
<span class="co">#&gt; 6126   483 6126    POINT (1.244926 6.451581)</span>
<span class="co">#&gt; 5624   584 5624  POINT (-0.7204456 7.630419)</span>
<span class="co">#&gt; 5207   444 5207    POINT (-0.546969 5.69943)</span>
<span class="co">#&gt; 5467   556 5467   POINT (-1.317769 6.855289)</span>
<span class="co">#&gt; 6316   557 6316   POINT (0.1700701 5.615775)</span>
<span class="co">#&gt; 5820   547 5820  POINT (0.08635421 7.123497)</span>
<span class="co">#&gt; 6313   525 6313   POINT (0.6675827 5.896631)</span>
<span class="co">#&gt; 5821   585 5821  POINT (-0.5705304 7.139334)</span>
<span class="co">#&gt; 5889   519 5889   POINT (0.6812513 6.188195)</span>
<span class="co">#&gt; 5126   407 5126 POINT (-0.09016363 5.843338)</span></code></pre></div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Daniele Da Re, Enrico Tordoni, Manuele Bazzichetto.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
