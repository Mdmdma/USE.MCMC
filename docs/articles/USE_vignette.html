<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="USE">
<title>USE vignette • USE</title>
<script src="../deps/jquery-3.6.1/jquery-3.6.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="USE vignette">
<meta property="og:description" content="USE">
<!-- mathjax --><script src="file:///usr/share/javascript/mathjax/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">USE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/USE_vignette.html">USE vignette</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/danddr/USE/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>USE vignette</h1>
                        <h4 data-toc-skip class="author">Daniele Da Re,
Enrico Tordoni, Manuele Bazzichetto</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/danddr/USE/blob/HEAD/vignettes/USE_vignette.Rmd" class="external-link"><code>vignettes/USE_vignette.Rmd</code></a></small>
      <div class="d-none name"><code>USE_vignette.Rmd</code></div>
    </div>

    
    
<style type="text/css">
  body{
  font-size: 12pt;
}
</style>
<p>This vignette shows the different functionalities, as well as related
practical examples, of the <code>USE</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://danddr.github.io/USE/" class="external-link">USE</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://borisleroy.com/virtualspecies/" class="external-link">virtualspecies</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="create-virtual-species">1. Create Virtual Species<a class="anchor" aria-label="anchor" href="#create-virtual-species"></a>
</h2>
<p>First, download the bioclimatic variables from WorldClim and crop
them to the European extent.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Worldclim</span> <span class="op">&lt;-</span> <span class="fu">geodata</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/geodata/man/worldclim.html" class="external-link">worldclim_global</a></span><span class="op">(</span>var<span class="op">=</span><span class="st">'bio'</span>, res<span class="op">=</span><span class="fl">10</span>, path<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">envData</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/crop.html" class="external-link">crop</a></span><span class="op">(</span><span class="va">Worldclim</span>, <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="op">-</span><span class="fl">12</span>, <span class="fl">25</span>, <span class="fl">36</span>, <span class="fl">60</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Then, generate a virtual species using the bioclimatic variables
downloaded in the previous step. For details about the methodology used
to create a virtual species, see the <a href="http://borisleroy.com/files/virtualspecies-tutorial.html#introduction" class="external-link">vignette</a>
of the <code>virtualspecies</code> R package.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#create virtual species</span></span>
<span><span class="va">myRandNum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">19</span>,size<span class="op">=</span><span class="fl">5</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">envData</span> <span class="op">&lt;-</span> <span class="va">envData</span><span class="op">[[</span><span class="va">myRandNum</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">random.sp</span> <span class="op">&lt;-</span> <span class="fu">virtualspecies</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/virtualspecies/man/generateRandomSp.html" class="external-link">generateRandomSp</a></span><span class="op">(</span><span class="va">envData</span>, </span>
<span>                                              convert.to.PA <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                                              species.type <span class="op">=</span> <span class="st">"additive"</span>,</span>
<span>                                              realistic.sp <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                              plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#reclassify suitability raster using a probability conversion rule</span></span>
<span><span class="va">new.pres</span> <span class="op">&lt;-</span> <span class="fu">virtualspecies</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/virtualspecies/man/convertToPA.html" class="external-link">convertToPA</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">random.sp</span>, </span>
<span>                      beta<span class="op">=</span><span class="fl">0.55</span>,</span>
<span>                      alpha <span class="op">=</span> <span class="op">-</span><span class="fl">0.05</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#Sample true occurrences</span></span>
<span><span class="va">presence.points</span> <span class="op">&lt;-</span> <span class="fu">virtualspecies</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/virtualspecies/man/sampleOccurrences.html" class="external-link">sampleOccurrences</a></span><span class="op">(</span><span class="va">new.pres</span>,</span>
<span>                                     n <span class="op">=</span> <span class="fl">300</span>, <span class="co"># The number of points to sample</span></span>
<span>                                     type <span class="op">=</span> <span class="st">"presence-absence"</span>,</span>
<span>                                     sample.prevalence <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>                                     detection.probability <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                     correct.by.suitability <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                     plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  </span></code></pre></div>
<p><img src="USE_vignette_files/figure-html/unnamed-chunk-5-1.png" width="768" style="display: block; margin: auto;"></p>
<p>Generate a presence-only data set.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myPres</span> <span class="op">&lt;-</span> <span class="va">presence.points</span><span class="op">$</span><span class="va">sample.points</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">presence.points</span><span class="op">$</span><span class="va">sample.points</span><span class="op">$</span><span class="va">Observed</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"x"</span>, <span class="st">"y"</span>,  <span class="st">"Observed"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">myPres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">myPres</span>, coords<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>, crs<span class="op">=</span><span class="fl">4326</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="generating-the-environmental-space">2. Generating the environmental space<a class="anchor" aria-label="anchor" href="#generating-the-environmental-space"></a>
</h2>
<p>First, the environmental space is generated by performing a principal
component analysis (PCA) on a raster stack that includes the selected
spatial environmental layers (such as precipitation and temperature). In
practice, the PCA operates on the values of the environmental conditions
linked to the pixels of the spatial environmental layers. Next, the
first two principal components are extracted from the PCA to create a
two-dimensional environmental space (it’s important to note that the
current version of USE only supports uniform sampling in two
dimensions).</p>
<p>Once the two principal components are obtained, a new “spatial
object” is created, with the PC-scores (which represent the projection
of the environmental pixels within the two-dimensional space) serving as
the object’s coordinates. This object is then scanned systematically to
gather pseudo-absences. It’s worth mentioning that, at this stage, all
PC-scores, except those associated with the presence of the virtual
species, are considered potential pseudo-absences.</p>
<p>The function <code><a href="../reference/optimRes.html">USE::optimRes</a></code> can be used to find the
optimal resolution (i.e., the one providing the best trade-off between a
fine resolution and the overfitting of the environmental space) of the
sampling grid that will be used to collect the pseudo-absences within
the environmental space (see below).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rpc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rastPCA.html">rastPCA</a></span><span class="op">(</span><span class="va">envData</span>, stand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/na.omit.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">rpc</span><span class="op">$</span><span class="va">PCs</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PC1"</span>, <span class="st">"PC2"</span><span class="op">)</span><span class="op">]</span><span class="op">]</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">dt</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PC1"</span>, <span class="st">"PC2"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myRes</span> <span class="op">&lt;-</span> <span class="fu">USE</span><span class="fu">::</span><span class="fu"><a href="../reference/optimRes.html">optimRes</a></span><span class="op">(</span>sdf<span class="op">=</span><span class="va">dt</span>,</span>
<span>                    grid.res<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>,</span>
<span>                    perc.thr <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                    showOpt <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                    cr<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p><img src="myOptRes.png"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myRes</span><span class="op">$</span><span class="va">Opt_res</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 5</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="uniform-sampling-of-the-environmental-space">3. Uniform sampling of the environmental space<a class="anchor" aria-label="anchor" href="#uniform-sampling-of-the-environmental-space"></a>
</h2>
<p>To provide a clear example, the function
<code><a href="../reference/uniformSampling.html">USE::uniformSampling</a></code> is utilized below to systematically
search through the environmental space and gather a specific number of
observations from each cell within the sampling grid. The resolution of
this grid was determined beforehand using the <code><a href="../reference/optimRes.html">USE::optimRes</a></code>
function. It’s important to note that in the given example, both the
presences and pseudo-absences of the virtual species are potentially
sampled by the <code><a href="../reference/uniformSampling.html">USE::uniformSampling</a></code> function, as the main
purpose is to demonstrate its operation. In the subsequent section, the
<code><a href="../reference/uniformSampling.html">USE::uniformSampling</a></code> function will be internally called by
<code><a href="../reference/paSampling.html">USE::paSampling</a></code>, exclusively focusing on sampling
pseudo-absences.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myObs</span> <span class="op">&lt;-</span> <span class="fu">USE</span><span class="fu">::</span><span class="fu"><a href="../reference/uniformSampling.html">uniformSampling</a></span><span class="op">(</span>sdf<span class="op">=</span><span class="va">dt</span>, </span>
<span>                              grid.res<span class="op">=</span><span class="va">myRes</span><span class="op">$</span><span class="va">Opt_res</span>,</span>
<span>                              n.tr <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                              sub.ts <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                              n.ts <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                              plot_proc <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Have a look at the observations sampled using
<code><a href="../reference/uniformSampling.html">USE::uniformSampling</a></code></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">myObs</span><span class="op">$</span><span class="va">obs.tr</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Simple feature collection with 6 features and 3 fields</span></span>
<span><span class="co">## Geometry type: POINT</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: -2.51107 ymin: -3.288937 xmax: -0.4052154 ymax: -2.683561</span></span>
<span><span class="co">## CRS:           NA</span></span>
<span><span class="co">##               x        y    ID                     geometry</span></span>
<span><span class="co">## 21228 -3.750000 43.41667 21228   POINT (-2.51107 -2.732245)</span></span>
<span><span class="co">## 21229 -3.583333 43.41667 21229  POINT (-2.380254 -2.724758)</span></span>
<span><span class="co">## 8783  -9.250000 53.08333  8783 POINT (-0.8998304 -2.970903)</span></span>
<span><span class="co">## 10100 -3.750000 52.08333 10100 POINT (-0.4052154 -2.683561)</span></span>
<span><span class="co">## 2601  -5.250000 57.91667  2601 POINT (-0.6417641 -3.288937)</span></span>
<span><span class="co">## 8585  -6.583333 53.25000  8585  POINT (-1.002097 -2.744004)</span></span></code></pre>
<p>Visualizing the coordinates (PC-scores) of the observations sampled
in the environmental space using <code><a href="../reference/uniformSampling.html">USE::uniformSampling</a></code>
demonstrates the effectiveness of uniformly sampling the environmental
space. This approach enables the collection of data that accurately
represents the entire range of environmental gradients. Moreover, it
mitigates the influence of “sample location bias,” which arises from
randomly sampling observations in the geographical space and often
results in an overrepresentation of the most frequently encountered
environmental conditions. Uniform sampling mitigates the adverse impact
of sample location bias, leading to a more comprehensive understanding
of environmental variations.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">env_pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">rpc</span><span class="op">$</span><span class="va">PCs</span><span class="op">$</span><span class="va">PC1</span>, <span class="va">rpc</span><span class="op">$</span><span class="va">PCs</span><span class="op">$</span><span class="va">PC2</span><span class="op">)</span></span>
<span><span class="va">env_pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/na.omit.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">env_pca</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">env_pca</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">PC1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"Environment"</span><span class="op">)</span>, linewidth<span class="op">=</span><span class="fl">1</span> <span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="va">myObs</span><span class="op">$</span><span class="va">obs.tr</span><span class="op">)</span><span class="op">)</span>, </span>
<span>               <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">X</span>,  color<span class="op">=</span><span class="st">"Uniform"</span><span class="op">)</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>name<span class="op">=</span><span class="cn">NULL</span>, </span>
<span>                     values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Environment'</span><span class="op">=</span><span class="st">'#1E88E5'</span>, <span class="st">'Uniform'</span><span class="op">=</span><span class="st">'#D81B60'</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>     </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y<span class="op">=</span><span class="st">"Density of PC-scores"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,  </span>
<span>        text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span><span class="op">)</span>,  </span>
<span>        legend.text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="USE_vignette_files/figure-html/unnamed-chunk-13-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">env_pca</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">PC2</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"Environment"</span><span class="op">)</span>, linewidth<span class="op">=</span><span class="fl">1</span> <span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="va">myObs</span><span class="op">$</span><span class="va">obs.tr</span><span class="op">)</span><span class="op">)</span>, </span>
<span>               <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Y</span>,  color<span class="op">=</span><span class="st">"Uniform"</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>name<span class="op">=</span><span class="cn">NULL</span>, </span>
<span>                     values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Environment'</span><span class="op">=</span><span class="st">'#1E88E5'</span>, <span class="st">'Uniform'</span><span class="op">=</span><span class="st">'#D81B60'</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>     </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y<span class="op">=</span><span class="st">"Density of PC-scores"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,  </span>
<span>        text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span><span class="op">)</span>,  </span>
<span>        legend.text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="USE_vignette_files/figure-html/unnamed-chunk-13-2.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="uniform-sampling-of-the-pseudo-absences-within-the-environmental-space">4. Uniform sampling of the pseudo-absences within the environmental
space<a class="anchor" aria-label="anchor" href="#uniform-sampling-of-the-pseudo-absences-within-the-environmental-space"></a>
</h2>
<p>The <code><a href="../reference/paSampling.html">USE::paSampling</a></code> function performs the uniform
sampling of the pseudo-absences within the environmental space through a
2-step procedure:</p>
<ul>
<li><p>First, a kernel-based filter is used to exclude from the
environmental space observations associated with environmental
conditions that are more likely to be suitable for the species. To
identify those conditions, the kernel-based filter uses information
about the environmental conditions where the species is present (i.e.,
presence locations). In a nutshell, kernel density estimation is used to
derive the probability density function of the observations associated
with the presence of the virtual species within the 2-dimensional
environmental space. The observations associated with a probability
equal to or greater than a given threshold (by default set to 0.75 in
<code><a href="../reference/paSampling.html">USE::paSampling</a></code>) are deemed to feature suitable
environmental conditions for the species. All observations within the
space characterized by this combination of environmental conditions have
therefore to be excluded from the subsequent step, namely the uniform
sampling of the pseudo-absences, to reduce the number of false-absences
introduced in the dataset used to train (and test) the species
distribution model. To this aim, a convex hull is built to delimit the
areas identified by the kernel-filter as those potentially featuring
suitable conditions for the virtual species, and all observations (i.e.,
PC-scores) within the convex hull are excluded from the environmental
space;</p></li>
<li><p>Second, the environmental space is systematically scanned to
uniformly sample the remaining observations, specifically those located
outside the convex hull established in the previous step. These sampled
observations constitute the set of pseudo-absences employed for training
and testing the species distribution model. This second step is carried
out with by the <code><a href="../reference/paSampling.html">USE::paSampling</a></code> function (internally called
by <code><a href="../reference/paSampling.html">USE::paSampling</a></code>). Pseudo-absences are randomly sampled
within each cell of the sampling grid mentioned in the previous
section.</p></li>
</ul>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myGrid.psAbs</span> <span class="op">&lt;-</span> <span class="fu">USE</span><span class="fu">::</span><span class="fu"><a href="../reference/paSampling.html">paSampling</a></span><span class="op">(</span>env.rast<span class="op">=</span><span class="va">envData</span>,</span>
<span>                                pres<span class="op">=</span><span class="va">myPres</span>,</span>
<span>                                thres<span class="op">=</span><span class="fl">0.75</span>,</span>
<span>                                H<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>                                grid.res<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">myRes</span><span class="op">$</span><span class="va">Opt_res</span><span class="op">)</span>,</span>
<span>                                n.tr <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                                prev<span class="op">=</span><span class="fl">0.3</span>,</span>
<span>                                sub.ts<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                                n.ts<span class="op">=</span><span class="fl">5</span>,</span>
<span>                                plot_proc<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                                verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Visualizing the coordinates (PC-scores) of the pseudo-absences
sampled in the environmental space using
<code><a href="../reference/paSampling.html">USE::paSampling</a></code></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">env_pca</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">PC1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"Environment"</span><span class="op">)</span>, linewidth<span class="op">=</span><span class="fl">1</span> <span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="va">myGrid.psAbs</span><span class="op">$</span><span class="va">obs.tr</span><span class="op">)</span><span class="op">)</span>, </span>
<span>               <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">X</span>,  color<span class="op">=</span><span class="st">"Uniform"</span><span class="op">)</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/extract.html" class="external-link">extract</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">rpc</span><span class="op">$</span><span class="va">PCs</span><span class="op">$</span><span class="va">PC1</span>, <span class="va">rpc</span><span class="op">$</span><span class="va">PCs</span><span class="op">$</span><span class="va">PC2</span><span class="op">)</span>, <span class="va">myPres</span>, df<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>               <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">PC1</span>, color<span class="op">=</span><span class="st">"Presence"</span><span class="op">)</span>, linewidth<span class="op">=</span><span class="fl">1</span> <span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>name<span class="op">=</span><span class="cn">NULL</span>, </span>
<span>                     values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Environment'</span><span class="op">=</span><span class="st">'#1E88E5'</span>, <span class="st">'Uniform'</span><span class="op">=</span><span class="st">'#D81B60'</span>, <span class="st">"Presence"</span><span class="op">=</span><span class="st">"black"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>     </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y<span class="op">=</span><span class="st">"Density of PC-scores"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,  </span>
<span>        text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span><span class="op">)</span>,  </span>
<span>        legend.text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="USE_vignette_files/figure-html/unnamed-chunk-15-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">env_pca</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">PC2</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"Environment"</span><span class="op">)</span>, linewidth<span class="op">=</span><span class="fl">1</span> <span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="va">myGrid.psAbs</span><span class="op">$</span><span class="va">obs.tr</span><span class="op">)</span><span class="op">)</span>, </span>
<span>               <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Y</span>,  color<span class="op">=</span><span class="st">"Uniform"</span><span class="op">)</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/extract.html" class="external-link">extract</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">rpc</span><span class="op">$</span><span class="va">PCs</span><span class="op">$</span><span class="va">PC1</span>, <span class="va">rpc</span><span class="op">$</span><span class="va">PCs</span><span class="op">$</span><span class="va">PC2</span><span class="op">)</span>, <span class="va">myPres</span>, df<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>               <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">PC2</span>, color<span class="op">=</span><span class="st">"Presence"</span><span class="op">)</span>, linewidth<span class="op">=</span><span class="fl">1</span> <span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>name<span class="op">=</span><span class="cn">NULL</span>, </span>
<span>                     values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Environment'</span><span class="op">=</span><span class="st">'#1E88E5'</span>, <span class="st">'Uniform'</span><span class="op">=</span><span class="st">'#D81B60'</span>, <span class="st">"Presence"</span><span class="op">=</span><span class="st">"black"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>     </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y<span class="op">=</span><span class="st">"Density of PC-scores"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,  </span>
<span>        text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span><span class="op">)</span>,  </span>
<span>        legend.text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="USE_vignette_files/figure-html/unnamed-chunk-15-2.png" width="576" style="display: block; margin: auto;"></p>
<p>Visualizing the geographic coordinates of the pseudo-absences sampled
in the environmental space using <code><a href="../reference/paSampling.html">USE::paSampling</a></code></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tidyterra</span><span class="fu">::</span><span class="fu"><a href="https://dieghernan.github.io/tidyterra/reference/geom_spatraster.html" class="external-link">geom_spatraster</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">new.pres</span><span class="op">$</span><span class="va">pa.raster</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span>na.value <span class="op">=</span> <span class="st">"transparent"</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">myPres</span>, </span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span> <span class="st">"Presences"</span><span class="op">)</span>, </span>
<span>          alpha<span class="op">=</span><span class="fl">1</span>, size<span class="op">=</span><span class="fl">2</span>, shape<span class="op">=</span> <span class="fl">19</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="va">myGrid.psAbs</span><span class="op">$</span><span class="va">obs.tr</span><span class="op">)</span>, </span>
<span>                        coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span>, crs<span class="op">=</span><span class="fl">4326</span><span class="op">)</span>, </span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"Pseudo-absences"</span><span class="op">)</span>, </span>
<span>          alpha<span class="op">=</span><span class="fl">0.8</span>, size<span class="op">=</span><span class="fl">2</span>, shape <span class="op">=</span> <span class="fl">19</span> <span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>name<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>                        values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Presences'</span><span class="op">=</span><span class="st">'steelblue'</span>,<span class="st">'Pseudo-absences'</span><span class="op">=</span><span class="st">'#A41616'</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Longitude"</span>, </span>
<span>       y<span class="op">=</span><span class="st">"Latitude"</span>, </span>
<span>       fill<span class="op">=</span><span class="st">"Virtual species"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,  </span>
<span>        legend.background<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        legend.box<span class="op">=</span><span class="st">"vertical"</span>,</span>
<span>        panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span><span class="op">)</span>,  </span>
<span>        legend.text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span><span class="op">)</span>, </span>
<span>        aspect.ratio <span class="op">=</span> <span class="fl">1</span>, </span>
<span>        panel.spacing.y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"lines"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="USE_vignette_files/figure-html/unnamed-chunk-16-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="effect-of-the-kernel-density-threshold-on-the-environmental-sub-space-sampled-to-collect-pseudo-absences">5. Effect of the kernel density threshold on the environmental
sub-space sampled to collect pseudo-absences<a class="anchor" aria-label="anchor" href="#effect-of-the-kernel-density-threshold-on-the-environmental-sub-space-sampled-to-collect-pseudo-absences"></a>
</h2>
<p>Knowing how <code><a href="../reference/paSampling.html">USE::paSampling</a></code> operates evidences the
importance of carefully selecting a meaningful threshold for the kernel
density estimation to delimit the environmental sub-space for the
uniform sampling. However, visualizing the impact of different threshold
selections can be challenging. To address this, we have incorporated the
<code><a href="../reference/thresh.inspect.html">USE::thresh.inspect</a></code> function. This function generates plots
that depict the entire environmental space alongside the portion that
would be excluded based on a specific kernel density threshold.</p>
<p>By experimenting with various threshold values, users can observe how
each selection affects the delineated area for collecting
pseudo-absences. In general, opting for a lower threshold value leads to
the exclusion of a larger portion of the environmental space. By
allowing users to freely determine the threshold value for the
kernel-based filter, <code>USE</code> enables the handling of
pseudo-absence sampling under diverse ecological scenarios, such as
those involving generalist or specialist species or sink
populations.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">USE</span><span class="fu">::</span><span class="fu"><a href="../reference/thresh.inspect.html">thresh.inspect</a></span><span class="op">(</span>env.rast<span class="op">=</span><span class="va">envData</span>,</span>
<span>                    pres<span class="op">=</span><span class="va">myPres</span>,</span>
<span>                    thres<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>                    H<span class="op">=</span><span class="cn">NULL</span></span>
<span>                    <span class="op">)</span></span></code></pre></div>
<p><img src="USE_vignette_files/figure-html/unnamed-chunk-17-1.png" width="864" style="display: block; margin: auto;"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Daniele Da Re, Enrico Tordoni, Manuele Bazzichetto.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
