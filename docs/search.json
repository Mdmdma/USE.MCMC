[{"path":"~ https://danddr.github.io/USE/articles/USE_vignette.html","id":"create-virtual-species","dir":"Articles","previous_headings":"","what":"Create Virtual Species","title":"USE vignette","text":"First, download bioclimatic variables WorldClim crop European extent details methodology used create virtual species, see vignette virtualspecies R package  Create presence data set.","code":"Worldclim <- geodata::worldclim_global(var='bio', res=10, path=getwd())  envData <- terra::crop(Worldclim, terra::ext(-12, 25, 36, 60)) #create virtual species myRandNum <- sample(1:19,size=5, replace = FALSE) envData <- envData[[myRandNum]] set.seed(123) random.sp <- virtualspecies::generateRandomSp(stack(envData),                                                convert.to.PA = FALSE,                                                species.type = \"additive\",                                               realistic.sp = TRUE,                                                plot = FALSE) #reclassify suitability raster using a probability conversion rule new.pres <- virtualspecies::convertToPA(x=random.sp,                        beta=0.55,                       alpha = -0.05, plot = FALSE) #Sample true occurrences presence.points <- virtualspecies::sampleOccurrences(new.pres,                                      n = 300, # The number of points to sample                                      type = \"presence-absence\",                                      sample.prevalence = 0.6,                                      detection.probability = 1,                                      correct.by.suitability = TRUE,                                      plot = TRUE) myPres <- presence.points$sample.points[which(presence.points$sample.points$Observed==1), c( \"x\", \"y\",  \"Observed\")] myPres <- st_as_sf(myPres, coords=c(\"x\", \"y\"), crs=4326)"},{"path":"~ https://danddr.github.io/USE/articles/USE_vignette.html","id":"find-the-optimal-resolution-of-the-sampling-grid","dir":"Articles","previous_headings":"","what":"Find the optimal resolution of the sampling grid","title":"USE vignette","text":"First, made PCA whole raster stack use PC-scores first two axes create new spatial object.","code":"rpc <- RStoolbox::rasterPCA(stack(envData), spca = TRUE) dt <- na.omit(as.data.frame(rpc$map[[c(\"PC1\", \"PC2\")]], xy = TRUE)) dt <- sf::st_as_sf(dt, coords = c(\"PC1\", \"PC2\")) myRes <- USE::optimRes(sdf=dt,                     grid.res=c(1:10),                     perc.thr = 20,                     showOpt = TRUE,                      cr=5) myRes$Opt_res #> [1] 5"},{"path":"~ https://danddr.github.io/USE/articles/USE_vignette.html","id":"uniform-sampling-of-the-environmental-space","dir":"Articles","previous_headings":"","what":"Uniform sampling of the environmental space","title":"USE vignette","text":"Perform uniform sampling environmental space look sampled observations training dataset Plot uniformly sampled PC-scores along observed PC-scores environmental space.","code":"myObs <- USE::uniformSampling(sdf=dt,                                grid.res=myRes$Opt_res,                               n.tr = 5,                               sub.ts = TRUE,                               n.ts = 2,                               plot_proc = FALSE) head(myObs$obs.tr) #> Simple feature collection with 6 features and 3 fields #> Geometry type: POINT #> Dimension:     XY #> Bounding box:  xmin: -2.511043 ymin: -2.980214 xmax: -0.3721179 ymax: -2.724728 #> CRS:           NA #>               x        y    ID                     geometry #> 22028 -3.750000 43.41667 22028  POINT (-2.511043 -2.732215) #> 22029 -3.583333 43.41667 22029  POINT (-2.380228 -2.724728) #> 9122  -8.750000 53.08333  9122  POINT (-0.770847 -2.927801) #> 3154  -4.416667 57.58333  3154 POINT (-0.7371618 -2.788707) #> 8458  -8.416667 53.58333  8458 POINT (-0.8849538 -2.980214) #> 9597  -3.583333 52.75000  9597 POINT (-0.3721179 -2.878996) env_pca <- stack(rpc$map$PC1, rpc$map$PC2) env_pca <- na.omit(as.data.frame(env_pca))  ggplot(env_pca, aes(x=PC1))+   geom_density(aes(color=\"Environment\"), size=1 )+   geom_density(data=data.frame(st_coordinates(myObs$obs.tr)),                 aes(x=X,  color=\"Uniform\"), size=1)+   scale_color_manual(name=NULL,                       values=c('Environment'='#1E88E5', 'Uniform'='#D81B60'))+        labs(y=\"Density of PC-scores\")+   xlim(-5,3)+ ylim(0,1)+   theme_classic()+   theme(legend.pos=\"bottom\",           text = element_text(size=14),           legend.text=element_text(size=12)) ggplot(env_pca, aes(x=PC2))+   geom_density(aes(color=\"Environment\"), size=1 )+   geom_density(data=data.frame(st_coordinates(myObs$obs.tr)),                 aes(x=Y,  color=\"Uniform\"), size=1)+   scale_color_manual(name=NULL,                       values=c('Environment'='#1E88E5', 'Uniform'='#D81B60'))+        labs(y=\"Density of PC-scores\")+   xlim(-5,3)+ ylim(0,1)+   theme_classic()+   theme(legend.pos=\"bottom\",           text = element_text(size=14),           legend.text=element_text(size=12))"},{"path":"~ https://danddr.github.io/USE/articles/USE_vignette.html","id":"uniform-sampling-of-the-pseudo-absences","dir":"Articles","previous_headings":"","what":"Uniform sampling of the pseudo-absences","title":"USE vignette","text":"Now seen uniformly sample environmental space, can uniformly sampling pseudo-absences environmental space accounting environmental space occupied species presence points.   Plot pseudo-absences geographic space","code":"myGrid.psAbs <- USE::paSampling(env.rast=envData,                                 pres=myPres,                                 thres=0.75,                                 H=NULL,                                 grid.res=as.numeric(myRes$Opt_res),                                 n.tr = 5,                                 prev=0.3,                                 sub.ts=TRUE,                                 n.ts=5,                                 plot_proc=FALSE,                                 verbose=FALSE) ggplot(env_pca, aes(x=PC1))+   geom_density(aes(color=\"Environment\"), size=1 )+   geom_density(data=data.frame(st_coordinates(myGrid.psAbs$obs.tr)),                 aes(x=X,  color=\"Uniform\"), size=1)+   geom_density(data=raster::extract(stack(rpc$map$PC1, rpc$map$PC2), myPres, df=TRUE),                 aes(x=PC1, color=\"Presence\"), size=1 )+   scale_color_manual(name=NULL,                       values=c('Environment'='#1E88E5', 'Uniform'='#D81B60', \"Presence\"=\"black\"))+        labs(y=\"Density of PC-scores\")+   xlim(-5,3)+ ylim(0,1)+   theme_classic()+   theme(legend.pos=\"bottom\",           text = element_text(size=14),           legend.text=element_text(size=12)) ggplot(env_pca, aes(x=PC2))+   geom_density(aes(color=\"Environment\"), size=1 )+   geom_density(data=data.frame(st_coordinates(myGrid.psAbs$obs.tr)),                 aes(x=Y,  color=\"Uniform\"), size=1)+   geom_density(data=raster::extract(stack(rpc$map$PC1, rpc$map$PC2), myPres, df=TRUE),                 aes(x=PC2, color=\"Presence\"), size=1 )+   scale_color_manual(name=NULL,                       values=c('Environment'='#1E88E5', 'Uniform'='#D81B60', \"Presence\"=\"black\"))+        labs(y=\"Density of PC-scores\")+   xlim(-5,3)+ ylim(0,1)+   theme_classic()+   theme(legend.pos=\"bottom\",           text = element_text(size=14),           legend.text=element_text(size=12)) ggplot()+   stars::geom_stars(data = stars::st_as_stars(new.pres$pa.raster) )+   scale_fill_manual(values =viridis::viridis(2),  na.value = \"transparent\",                    labels = c(\"Absence\", \"Presence\", \"\"))+   geom_sf(data=myPres,            aes(color= \"Presences\"), alpha=0.8, size=0.8)+   geom_sf(data=st_as_sf(st_drop_geometry(myGrid.psAbs$obs.tr),                          coords = c(\"x\",\"y\"), crs=4326),            aes(color=\"Pseudo-absences\"), alpha=0.8, size=0.8)+   scale_colour_manual(name=NULL,                        values=c('Presences'='#16847F', 'Pseudo-absences'='#A41616'))+   labs(x=\"Longitude\",y=\"Latitude\", fill=\"Virtual species\")+   theme_light()+   theme(legend.pos=\"bottom\",           legend.background=element_blank(),         legend.box=\"vertical\",         panel.grid = element_blank(),         text = element_text(size=14),           legend.text=element_text(size=14),          aspect.ratio = 1,          panel.spacing.y = unit(2, \"lines\"))"},{"path":"~ https://danddr.github.io/USE/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Daniele Da Re. Author, maintainer. Enrico Tordoni. Author. Manuele Bazzichetto. Author.","code":""},{"path":"~ https://danddr.github.io/USE/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Da Re D, Tordoni E, Bazzichetto M (2023). USE: Uniform Sampling Environmental space. R package version 0.0.0.9000.","code":"@Manual{,   title = {USE: Uniform Sampling of the Environmental space},   author = {Daniele {Da Re} and Enrico Tordoni and Manuele Bazzichetto},   year = {2023},   note = {R package version 0.0.0.9000}, }"},{"path":"~ https://danddr.github.io/USE/index.html","id":"use-uniform-sampling-of-the-environmental-space","dir":"","previous_headings":"","what":"Uniform Sampling of the Environmental space","title":"Uniform Sampling of the Environmental space","text":"R package perform uniform sampling environmental space   goal USE perform uniform sampling environmental space","code":""},{"path":"~ https://danddr.github.io/USE/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Uniform Sampling of the Environmental space","text":"can install development version USE like :","code":"# Install the released version from CRAN # install.packages(\"USE\") #not available yet # Or the development version from GitHub: # install.packages(\"devtools\") devtools::install_github(\"danddr/USE\")"},{"path":[]},{"path":"~ https://danddr.github.io/USE/index.html","id":"examples","dir":"","previous_headings":"","what":"Examples","title":"Uniform Sampling of the Environmental space","text":"apply USE shown vignette example provided https://github.com/danddr/USE_paper/tree/main/Example.","code":""},{"path":"~ https://danddr.github.io/USE/reference/Worldclim_tmp.html","id":null,"dir":"Reference","previous_headings":"","what":"A subset of WorldClim bioclimatic variables — Worldclim_tmp","title":"A subset of WorldClim bioclimatic variables — Worldclim_tmp","text":"subset WorldClim bioclimatic variables cropped Central Western Europe.","code":""},{"path":"~ https://danddr.github.io/USE/reference/Worldclim_tmp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A subset of WorldClim bioclimatic variables — Worldclim_tmp","text":"","code":"data(Worldclim_tmp)"},{"path":"~ https://danddr.github.io/USE/reference/Worldclim_tmp.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"A subset of WorldClim bioclimatic variables — Worldclim_tmp","text":"RasterLayer 1080 rows, 2160 columns, 5 layers, namely: wc2.1_10m_bio_4, wc2.1_10m_bio_3, wc2.1_10m_bio_14, wc2.1_10m_bio_9, wc2.1_10m_bio_15.","code":""},{"path":"~ https://danddr.github.io/USE/reference/Worldclim_tmp.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"A subset of WorldClim bioclimatic variables — Worldclim_tmp","text":"geodata::worldclim_global(var='bio', res=10, path=getwd())[[c(4,  3, 14,  9, 15)]]","code":""},{"path":"~ https://danddr.github.io/USE/reference/optimRes.html","id":null,"dir":"Reference","previous_headings":"","what":"Get optimal resolution of the sampling grid — optimRes","title":"Get optimal resolution of the sampling grid — optimRes","text":"optimRes identifies optimal resolution sampling grid used perform uniform environmental sampling. function requires sf object geometry type “POINT”. Points scores first two axes principal component analysis performed correlation matrix set environmental variables. set candidate resolutions must provided find optimal resolution sampling grid. candidate resolution, optimRes computes metric summarizing average squared Euclidean distance points within cell centroid convex hull built around points. metric compared across different sampling grids increasing resolution (.e., number cells). best resolution selected one allowing finding best trade-number cells average distance among points within cells. words, resolution allowing uniformly sampling environmental space without overfitting . obtained choosing average distance among pseudo-absences reduced 10% (10% default value, another threshold can set user). optimRes returns list length 2 matrix reporting measure computed sampling grid corresponding resolution selected optimal resolution. function also provides plot displaying function values resolution, allowing user select resolution .","code":""},{"path":"~ https://danddr.github.io/USE/reference/optimRes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get optimal resolution of the sampling grid — optimRes","text":"","code":"optimRes(sdf, grid.res, perc.thr = 10, cr = 1, showOpt = TRUE)"},{"path":"~ https://danddr.github.io/USE/reference/optimRes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get optimal resolution of the sampling grid — optimRes","text":"sdf sf object point geometry given PC-scores values grid.res (integer) vector resolutions tested, .e seq(1,100, =1) perc.thr rate change (expressed percentage) function minimized selecting optimal resolution. cr (integer) number cores parallel computing. default cluster type PSOCK. showOpt (logical) plot result.","code":""},{"path":"~ https://danddr.github.io/USE/reference/optimRes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get optimal resolution of the sampling grid — optimRes","text":"returns list : ) matrix reporting values function minimized, along corresponding resolution; ii) optimal resolution.","code":""},{"path":"~ https://danddr.github.io/USE/reference/optimRes.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get optimal resolution of the sampling grid — optimRes","text":"case function returns NA optimal resolution: ) increase range grid.res, ii) increase perc.thr.","code":""},{"path":"~ https://danddr.github.io/USE/reference/paSampling.html","id":null,"dir":"Reference","previous_headings":"","what":"Sampling pseudo-absences for the training and testing datasets. — paSampling","title":"Sampling pseudo-absences for the training and testing datasets. — paSampling","text":"paSampling internally calls uniformSampling function, performs uniform sampling environmental space. performing uniform sampling environmental space, environmental space partitioned follows: kernel density estimate species presence observations identifies excludes portion environmental space associated environmental conditions likely suitable species establish using threshold specified user. bandwidth kernel can estimated automatically defined user, allowing account meta-population dynamics (e.g. sink-source populations).","code":""},{"path":"~ https://danddr.github.io/USE/reference/paSampling.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sampling pseudo-absences for the training and testing datasets. — paSampling","text":"","code":"paSampling(   env.rast,   pres = NULL,   thres = 0.75,   H = NULL,   grid.res = NULL,   n.tr = 5,   sub.ts = FALSE,   n.ts = 5,   prev = NULL,   plot_proc = FALSE,   verbose = FALSE )"},{"path":"~ https://danddr.github.io/USE/reference/paSampling.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sampling pseudo-absences for the training and testing datasets. — paSampling","text":"env.rast RasterStack, RasterBrick SpatRaster object comprising variables describing environmental space. pres SpatialPointsDataframe, SpatVector sf object including presence-observations species interest. thres (double) value identifies quantile value used specify boundary kernel density estimate (default thres=0.75 ). Thus, probability values higher threshold indicate portions multivariate space likely associated presence points. H kernel bandwidth (.e., width kernel density function defines shape) excluding portion environmental space associated environmental conditions likely suitable species. can either defined user automatically estimated paSampling via ks::Hpi. grid.res (integer) resolution sampling grid. resolution can arbitrarily selected defined using optimRes function. n.tr (integer) number pseudo-absences training dataset sample cell sampling grid sub.ts (logical) sample validation pseudo-absences n.ts (integer; optional) number pseudo-absences testing dataset sample cell sampling grid. sub.ts argument must TRUE. prev (double) prevalence value specified instead n.tr n.ts plot_proc (logical) plot progress sampling, default FALSE verbose (logical) Print verbose","code":""},{"path":"~ https://danddr.github.io/USE/reference/paSampling.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sampling pseudo-absences for the training and testing datasets. — paSampling","text":"sf object coordinates pseudo-absences geographical environmental space.","code":""},{"path":"~ https://danddr.github.io/USE/reference/uniformSampling.html","id":null,"dir":"Reference","previous_headings":"","what":"Uniform sampling of the environmental space — uniformSampling","title":"Uniform sampling of the environmental space — uniformSampling","text":"uniformSampling performs uniform sampling environmental space. requires sf object geometry type “POINT”. Points scores first two axes principal component analysis performed correlation matrix set environmental variables. resolution sampling grid used systematically collect observations within environmental space must provided. resolution can either set arbitrary value user selected using optimRes() function. uniformSampling allows collecting observations populate training (optional) testing dataset. cases, user must provide number points sampled cell sampling grid (n.tr: points training dataset; n.ts: points testing dataset). Note number pseudo-absences eventually sampled depends spatial configuration points within environmental space. Usually, cells sampling grid empty (.e., include points), points covering whole extent environmental space. reason, number pseudo-absences eventually collected likely lower product resolution sampling grid n.tr(n.ts).","code":""},{"path":"~ https://danddr.github.io/USE/reference/uniformSampling.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Uniform sampling of the environmental space — uniformSampling","text":"","code":"uniformSampling(   sdf,   grid.res,   n.tr = 5,   n.prev = NULL,   sub.ts = FALSE,   n.ts = 5,   plot_proc = FALSE,   verbose = FALSE )"},{"path":"~ https://danddr.github.io/USE/reference/uniformSampling.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Uniform sampling of the environmental space — uniformSampling","text":"sdf sf object point geometry given PC-scores values grid.res (integer) resolution sampling grid. resolution can arbitrarily selected defined using optimRes() function. n.tr (integer; optional) number expected points given certain prevalence threshold training dataset. n.prev (double) sample prevalence sub.ts (logical) sample validation points n.ts (integer; optional) number  points testing dataset sample cell sampling grid. sub.ts argument must TRUE. plot_proc (logical) plot progress sampling verbose (logical) Print verbose","code":""},{"path":"~ https://danddr.github.io/USE/reference/uniformSampling.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Uniform sampling of the environmental space — uniformSampling","text":"sf object coordinates sampled points geographical environmental space","code":""}]
